# 智能矩阵分析图 (Smart Matrix Diagram) 用户手册 🕸️🏆

矩阵图（Matrix Diagram）是质量管理中用于分析两组或多组因素之间相互关系强弱的强力工具。它不仅能直观展示“是什么影响了什么”，还能通过**量化评分**体系，帮助决策者锁定系统中的核心变量。

---

## 一、 核心分析逻辑 (Analysis Logic)

矩阵图的核心价值在于通过“权重传递”来识别重要性。

### 1. 评分计算公式
对于任何一个项目 $i$，其分值 $S_i$ 计算如下：
$$S_i = \sum (W_{adj} \times V_{symbol})$$
其中：
- $W_{adj}$：关联项的定义权重（默认为 1，除非显式修改）。
- $V_{symbol}$：关系符号的分值（◎ 强=9, ○ 中=3, △ 弱=1, 0=无）。

### 2. 不同矩阵型的管理学意义

| 矩阵类型 | 分析视角 | 高分项（High Score）的内涵 |
| :--- | :--- | :--- |
| **L型 (二元)** | **直接映射** | 承载了最多的输入需求或受最多的上游约束。 |
| **T型 (三元)** | **传递/分配** | 在两个不同的目标轴之间起到关键的中转或平衡作用。 |
| **Y型 (三维)** | **闭环影响** | 代表系统中由于三向关联累积而成的“期望最高点”或“风险集中点”。 |
| **X型 (四元)** | **匹配/瓶颈** | 通常位于跨边界协作（如组织-流程-资源）的**枢纽位置**。 |
| **C型 (自相关)** | **耦合度** | 系统的“敏感变量”，改动该项会引起最广泛的连锁反应（正向或冲突）。 |

---

## 二、 DSL 语法规范 (Full Specification)

本工具采用自研 Matrix DSL，语法结构严谨且易于扩展。

### 1. 全局配置 (Metadata)
| 关键词 | 说明 | 示例 |
| :--- | :--- | :--- |
| `Title:` | 图表主标题 | `Title: 关键特性关系矩阵` |
| `Type:` | 布局类型 (L, T, Y, X, C) | `Type: Y` |
| `CellSize:` | 单元格尺寸 | `CellSize: 45` |
| `Orientation:` | 渲染方向 (Top/Bottom) | `Orientation: Bottom` |

### 2. 权重与字号 (Standard Control)
- **自定义符号分值**：`Weight[Strong]: 10`, `Weight[Medium]: 5`, `Weight[Weak]: 1`
- **字号设置**：`Font[Title]: 24`, `Font[Base]: 12`, `Font[Score]: 10`
- **颜色控制**：`Color[Axis]: #334155`, `Color[Grid]: #cbd5e1`

### 3. 维度定义 (Axis & Items)
支持定义多个轴，每个轴拥有独立的 ID 和 标签。

**定义语法：**
```
Axis: [ID], [Label]
- [ItemID], [ItemLabel], [Weight]
```

**权重定义写法：**
- **CSV 写法**：`- r1, 零件材料, 10`
- **标签标注**：`- r1, 零件材料 [10]` (系统会自动解析 `[10]` 并用于计算)

### 4. 矩阵关系定义 (Matrix Mapping)
**声明矩阵：**
`Matrix: [RowAxisID] x [ColAxisID]`

**录入数据：**
格式：`RowID: ColID:Symbol, ColID:Symbol...`
示例：`r1: c1:S, c2:M, c3:W` (S=Strong, M=Medium, W=Weak)

---

## 三、 实战案例

### X型：人力-目标-流程-资源 匹配
```matrix
Title: 企业战略对标矩阵
Type: X
Order: N, E, S, W

Axis: W, 战略目标
- w1, 降本增效 [10]
- w2, 品牌升级 [8]

Axis: N, 业务流程
- n1, 研发流程
- n2, 生产流程

Matrix: W x N
w1: n1:M, n2:S
w2: n1:S, n2:M

# ... (后续定义 E轴 和 S轴 及对应 Matrix)
```

---

## 四、 常见问题 (FAQ)

**Q: 为什么我定义的权重没有参与计算？**
A: 请确保权重是数字，且放置在第三列或标签末尾的 `[]` 内。

**Q: C型矩阵为什么只显示一半？**
A: C型矩阵（自相关）在逻辑上是对称的，因此系统采用经典的“屋顶/对角线平衡”显示方案，以提升可读性。

---
© 2026 Smart QC Studio | Matrix Analysis Engine V1.1
