# 《Smart QC Tools 矢线图模块》使用手册
**（软件著作权申请建议参考文档版本）**

---

## 1. 软件概述

### 1.1 软件名称及版本
**软件名称**：Smart QC Tools 工业级质量控制软件  
**版本号**：V1.0  
**功能模块**：矢线图分析模块（Arrow Diagram / PERT / CPM Module）

### 1.2 开发背景与用途
矢线图（Arrow Diagram），又称网络计划技术（PERT/CPM），是计划管理与进度控制的核心工具。本软件矢线图模块通过自研的 **CPM (Critical Path Method) 计算引擎**，解决了复杂项目排程中人工计算量大、逻辑易错、关键路径不直观的问题。软件能够自动计算最早开始时间（ES）、最迟开始时间（LS）、总时差（TF）及识别关键路径（Critical Path），为工程管理人员提供科学的决策支持。

---

## 2. 软件运行环境

### 2.1 硬件要求
- **CPU**：1.6GHz 以上多核处理器
- **内存**：2GB (建议 4GB 及以上)
- **显示器**：分辨率 1280x800 或以上

### 2.2 软件要求
- **操作系统**：跨平台支持（Windows, macOS, Linux）
- **渲染引擎**：高效 Canvas 渲染引擎，支持高维拓扑布局

---

## 3. 核心功能及操作规程

### 3.1 模块主界面
用户通过导航进入 “Arrow Diagram” 模块。界面分为：
1. **控制中心**：支持“手动逻辑构建”、“DSL 编辑器”、“AI 自动编排”三种模式。
2. **动态画布**：实时渲染网络结构，支持关键路径自动高亮及交互式节点查看。

---

### 3.2 模式一：手动逻辑构建 (Manual Logic Builder)
**功能描述**：通过标准表单定义项目里程碑（事件）与作业活动。

**操作步骤**：
1. **节点(Event)定义**：点击“添加节点”，设定编号（如 1, 2...）与描述（如 厂房封顶）。
2. **任务(Activity)联结**：
   - 选择起始节点与终止节点。
   - 输入任务名称（项）及预计工期（天/时）。
   - 选择是否为“虚任务（Dummy Activity）”（工期为0，仅表逻辑约束）。
3. **即时计算**：每添加一条逻辑，引擎自动执行前推/后推算法，并在右侧更新网络视图。

---

### 3.3 模式二：Arrow DSL 语法专家模式
**功能描述**：通过极简的声明式语法定义复杂的逻辑网，支持快速粘贴项目清单。

**语法规范**：
- `Title: [标题]`：设定项目名称。
- `ShowCritical: true/false`：全局关键路径高亮开关。
- `Event: [ID], [别名]`：显式定义里程碑。
- `ID1 -> ID2 : [工期], [内容]`：实活动定义。
- `ID1 ..> ID2 : 0, [内容]`：虚活动定义。

**操作规程**：
工程师可直接在代码框中录入逻辑，例如：
```arrow
1 -> 2 : 5, 需求分析
2 -> 3 : 10, 架构设计
```
系统 Parser 实现毫秒级语义扫描，实现“输入即分析”。

---

### 3.4 核心算法逻辑：CPM 分析说明
本模块内置了工业级的关键路径法计算逻辑：
1. **前推计算 (Forward Pass)**：
   - 计算各节点最早开始时间 (ES)。
   - `ES[target] = Max(ES[source] + Duration)`。
2. **后推计算 (Backward Pass)**：
   - 计算各节点最迟开始时间 (LS)。
   - `LS[source] = Min(LS[target] - Duration)`。
3. **时差计算与关键路径识别**：
   - **总时差 (Total Float)**：`TF = LS - ES`。
   - **关键活动**：当 `TF = 0` 时的作业活动即为关键活动，构成的路径即为关键路径。关键路径决定了项目的总工期，是管理的重中之重。

---

## 4. 技术特性亮点（申办要点）

1. **自适应时空排布布局 (Adaptive Temporal Layout)**：
   - 算法自动根据工期长度与逻辑层级，计算各节点的 X-Y 坐标，确保长工期任务在视觉上具有物理长度表现，逻辑排布层次分明，避免连线交叉堆叠。
2. **逻辑冲突自动检测**：
   - 内置环路检测（Cycle Detection）算法，当用户录入的回路产生逻辑冲突时，系统实时预警并阻断非法渲染。
3. **关键路径动态演化引擎**：
   - 对任意一项任务工期的微调，系统都会实时重构时间链条。若非关键路径活动演变为关键路径，系统会自动切换高亮显示。

---
*版本日期：2026年2月*  
* Smart QC Tools 矢线图研发组 归档*
